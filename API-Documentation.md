# توثيق API لأوقات الصلاة - Al-Rayyan API

## نظرة عامة
هذا API يقدم أوقات الصلاة بناءً على موقع المستخدم المحدد من عنوان IP الخاص به. يستخدم مكتبة Adhan لحساب أوقات الصلاة بدقة.

## نقطة النهاية (Endpoint)
- **URL**: `/api/v1/prayer-times`
- **طريقة الطلب**: GET
- **الوصف**: يرجع أوقات الصلاة لليوم الحالي بناءً على موقع المستخدم.

## المعلمات (Parameters)
يمكن تمرير المعلمات كـ query parameters:

- `method` (اختياري): طريقة الحساب. القيم المدعومة:
  - `EGYPT` (افتراضي): الهيئة المصرية العامة للمساحة
  - `UMM_AL_QURA`: أم القرى (السعودية)
  - `MWL`: رابطة العالم الإسلامي
  - `KARACHI`: كراتشي
  - `NORTH_AMERICA`: أمريكا الشمالية
  - `DUBAI`: دبي
  - `KUWAIT`: الكويت
  - `QATAR`: قطر
  - `SINGAPORE`: سنغافورة
  - `TURKEY`: تركيا

- `madhab` (اختياري): المذهب. القيم المدعومة:
  - `SHAFI` (افتراضي): الشافعي
  - `HANAFI`: الحنفي

## كيفية عمل الـ API
1. **تحديد عنوان IP**: يأخذ الـ API عنوان IP من الطلب (headers أو socket). إذا كان localhost، يستخدم IP تجريبي لمصر.
2. **تحويل IP إلى موقع جغرافي**: يستخدم مكتبة geoip-lite للحصول على الإحداثيات (latitude, longitude) والمدينة والبلد والمنطقة الزمنية من IP دون استدعاء APIs خارجية.
3. **إعدادات الحساب**: يضبط طريقة الحساب و المذهب بناءً على المعلمات أو الافتراضيات.
4. **حساب أوقات الصلاة**: يحسب أوقات الصلاة للتاريخ الحالي باستخدام مكتبة Adhan.
5. **تنسيق الوقت**: ينسيق الأوقات حسب المنطقة الزمنية للمستخدم باستخدام moment-timezone.

## مثال على الاستجابة (Response)
```json
{
  "metadata": {
    "city": "Cairo",
    "country": "EG",
    "timezone": "Africa/Cairo",
    "coordinates": {
      "lat": 30.0444,
      "lng": 31.2357
    }
  },
  "timings": {
    "Fajr": "04:30",
    "Sunrise": "06:00",
    "Dhuhr": "12:00",
    "Asr": "15:30",
    "Maghrib": "18:00",
    "Isha": "19:30"
  }
}
```

## أخطاء محتملة
- **404**: لا يمكن تحديد الموقع من IP.
- الرسالة: "Could not determine location from IP"

## ملاحظات
- الأوقات بتنسيق 24 ساعة (HH:mm).
- المنطقة الزمنية تُحدد تلقائياً من IP، أو افتراضياً Africa/Cairo.
- لا يتطلب تسجيل أو مفتاح API.
- يعمل محلياً دون اتصال بالإنترنت للبحث عن الموقع.

## كيفية التشغيل
1. قم بتثبيت التبعيات: `npm install`
2. شغل الخادم: `node index.js` أو `npm start` إذا كان هناك script.
3. الوصول إلى الـ API على `http://localhost:3000/api/v1/prayer-times`

## التبعيات
- express: للخادم
- geoip-lite: لتحويل IP إلى موقع
- adhan: لحساب أوقات الصلاة
- moment-timezone: لتنسيق الوقت حسب المنطقة الزمنية